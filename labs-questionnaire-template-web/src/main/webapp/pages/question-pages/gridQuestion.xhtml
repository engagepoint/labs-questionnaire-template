<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ago="http://java.sun.com/jsf/composite/questiontemplate" xmlns:uib="http://java.sun.com/jsf/html"
                template="/templates/questionEdit.xhtml">

    <ui:define name="page">

        <f:metadata>
            <f:viewParam name="template" value="#{templateController.currentTemplate.id}"/>
            <f:viewParam name="question" value="#{gridQuestionController.currentQuestion.id}"/>
        </f:metadata>

        <h:form id="form">
            <ago:questioncommon qb="#{gridQuestionController.currentQuestion}" id="formWithCommonProps"/>
            <p:selectBooleanCheckbox itemLabel="Only one selection in column"
                                     value="#{gridQuestionController.onlyOneSelectInCol}"/>
            <br/>
            <p:selectBooleanCheckbox itemLabel="Only one selection in row"
                                     value="#{gridQuestionController.onlyOneSelectInRow}"/>

            <br/>
            <p:commandButton id="cmdEditRow"
                             value="Edit rows"
                             action="#{gridQuestionController.editRows()}"
                             update=":dlgEditListForm"
                             oncomplete="dlgEditList.show();"/>
            <h:outputText value=" "/>
            <p:commandButton id="cmdEditCol"
                             value="Edit columns"
                             action="#{gridQuestionController.editColumns()}"
                             update=":dlgEditListForm"
                             oncomplete="dlgEditList.show();"/>

            <p/>
            <p:dataTable id="gridTable"
                         var="row"
                         value="#{gridQuestionController.rowsSize}"
                         scrollable="true">
                <p:column>
                    <f:facet name="header">
                        <p:outputLabel value="" style="width: 200px;"/>
                    </f:facet>
                    <p:outputLabel value="#{gridQuestionController.getRow(row)}"
                                   style="width: 200px"/>
                </p:column>

                <p:columns var="column"
                           value="#{gridQuestionController.columnsSize}">
                    <f:facet name="header">
                        <p:outputLabel value="#{gridQuestionController.getColumn(column)}"
                                       style="width: 200px;"/>
                    </f:facet>
                    <p:selectBooleanCheckbox
                            value="#{gridQuestionController.setCurrentPosition(row, column).currentSelected}"
                            style="width: 200px;"/>
                </p:columns>
            </p:dataTable>

            <br/>
            <ago:buttonsCommon qbuttons="#{gridQuestionController}" id="formWithSaveButtons"/>
        </h:form>

        <p:dialog id="dlgEditListDialog"
                  header="Edit ..."
                  widgetVar="dlgEditList"
                  modal="true" height="200" width="800">
            <h:form id="dlgEditListForm">
                <uib:dataTable id="dlgEditListTable"
                               var="iterator"
                               value="#{gridEditParamsController.positions}">
                    <p:column headerText="Delete">
                        <p:selectBooleanCheckbox
                                value="#{gridEditParamsController.setPosition(iterator).markAsDelete}"/>
                    </p:column>
                    <p:column>
                        <p:inputText value="#{gridEditParamsController.setPosition(iterator).param}"/>
                    </p:column>
                </uib:dataTable>

                <br/>
                <p:commandButton id="cmdAddParam"
                                 value="Add"
                                 action="#{gridEditParamsController.add}"
                                 update=":dlgEditListForm:dlgEditListTable"/>
                <h:outputText value=" "/>
                <p:commandButton id="cmdOk"
                                 value="OK"
                                 onclick="submit()"
                                 oncomplete="dlgEditList.hide()"
                                 update=":form:gridTable"/>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>